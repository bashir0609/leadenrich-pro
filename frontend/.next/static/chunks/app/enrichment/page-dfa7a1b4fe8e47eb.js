(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[838],{3887:function(e,s,l){Promise.resolve().then(l.bind(l,8797))},8797:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return j}});var t=l(7437),r=l(2265),a=l(9376),i=l(6952),n=l(9782),c=l(2381),d=l(9820),o=l(7168),u=l(3649),m=l(1806),x=l(1175),h=l(9064),p=l(2660),f=l(5863);function j(){let e=(0,a.useRouter)(),{selectedProvider:s}=(0,u.D)(),{addJob:l}=(0,x.d)(),j=(0,m.kr)(),[g,b]=(0,r.useState)(null),[v,N]=(0,r.useState)(null),[y,w]=(0,r.useState)({}),[S,Z]=(0,r.useState)(!1),[C,E]=(0,r.useState)(0);if((0,r.useEffect)(()=>{s||e.push("/")},[s,e]),!s)return null;let P=async e=>{b(e),Z(!0),E(0);let s=new FormData;s.append("file",e);try{let e=setInterval(()=>{E(e=>Math.min(e+10,90))},200),l=await fetch("".concat("http://localhost:3002","/api/upload/csv"),{method:"POST",body:s});if(clearInterval(e),E(100),!l.ok)throw Error("Upload failed");let t=await l.json();N(t.data.data);let r={};t.data.suggestions.forEach(e=>{r[e.targetField]=e.sourceColumn}),w(r),h.ZP.success("File uploaded successfully! ".concat(t.data.totalRows," rows detected."))}catch(e){h.ZP.error("Failed to upload file"),b(null)}finally{Z(!1),E(0)}},k=[{field:"email",label:"Email",required:!0},{field:"firstName",label:"First Name",required:!1},{field:"lastName",label:"Last Name",required:!1},{field:"company",label:"Company",required:!1},{field:"domain",label:"Domain",required:!1},{field:"phone",label:"Phone",required:!1}],F=async()=>{if(v&&s){if(!k.filter(e=>e.required).every(e=>y[e.field])){h.ZP.error("Please map all required fields");return}try{let t=v.preview.map(e=>{let s={};return Object.entries(y).forEach(l=>{let[t,r]=l;s[t]=e[r]}),s}),r=await j.mutateAsync({providerId:s.name,data:{operation:"enrich-person",records:t,options:{columnMapping:y}}});l({id:r.jobId,status:"queued",progress:{total:r.data.totalRecords,processed:0,successful:0,failed:0},createdAt:new Date().toISOString(),logs:[]}),h.ZP.success("Enrichment job started!"),e.push("/jobs/".concat(r.jobId))}catch(e){h.ZP.error("Failed to start enrichment")}}};return(0,t.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>e.push("/"),children:(0,t.jsx)(p.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Data Enrichment"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Using ",s.displayName," provider"]})]})]})}),(0,t.jsxs)(o.mQ,{defaultValue:"bulk",className:"w-full",children:[(0,t.jsxs)(o.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(o.SP,{value:"single",children:"Single Enrichment"}),(0,t.jsx)(o.SP,{value:"bulk",children:"Bulk Enrichment"})]}),(0,t.jsx)(o.nU,{value:"single",children:(0,t.jsxs)(d.Zb,{children:[(0,t.jsxs)(d.Ol,{children:[(0,t.jsx)(d.ll,{children:"Single Record Enrichment"}),(0,t.jsx)(d.SZ,{children:"Enrich a single contact or company"})]}),(0,t.jsx)(d.aY,{children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Single enrichment coming soon..."})})]})}),(0,t.jsxs)(o.nU,{value:"bulk",className:"space-y-6",children:[(0,t.jsxs)(d.Zb,{children:[(0,t.jsxs)(d.Ol,{children:[(0,t.jsx)(d.ll,{children:"Step 1: Upload Your Data"}),(0,t.jsx)(d.SZ,{children:"Upload a CSV file with the leads you want to enrich"})]}),(0,t.jsx)(d.aY,{children:(0,t.jsx)(i.p,{onFileSelect:P,uploading:S,progress:C})})]}),v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.Zb,{children:[(0,t.jsxs)(d.Ol,{children:[(0,t.jsx)(d.ll,{children:"Step 2: Map Your Columns"}),(0,t.jsx)(d.SZ,{children:"Tell us which columns contain which data"})]}),(0,t.jsx)(d.aY,{children:(0,t.jsx)(n.L,{headers:v.headers,columnTypes:v.columnTypes,suggestions:v.suggestions,targetFields:k,onChange:w})})]}),(0,t.jsxs)(d.Zb,{children:[(0,t.jsxs)(d.Ol,{children:[(0,t.jsx)(d.ll,{children:"Step 3: Preview & Start"}),(0,t.jsx)(d.SZ,{children:"Review your data before starting enrichment"})]}),(0,t.jsxs)(d.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Total Records"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:v.totalRows})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Estimated Credits"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:2*v.totalRows})]})]}),(0,t.jsxs)("div",{className:"bg-muted rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Data Preview"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:Object.keys(y).map(e=>(0,t.jsx)("th",{className:"px-2 py-1 text-left",children:e},e))})}),(0,t.jsx)("tbody",{children:v.preview.slice(0,3).map((e,s)=>(0,t.jsx)("tr",{children:Object.entries(y).map(s=>{let[l,r]=s;return(0,t.jsx)("td",{className:"px-2 py-1",children:e[r]||"-"},l)})},s))})]})})]}),(0,t.jsx)(c.z,{className:"w-full",size:"lg",onClick:F,disabled:j.isPending,children:j.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Starting..."]}):"Start Enrichment"})]})]})]})]})]})]})}},6952:function(e,s,l){"use strict";l.d(s,{p:function(){return m}});var t=l(7437),r=l(2265),a=l(7598),i=l(7689),n=l(9658),c=l(2489),d=l(2381),o=l(7204),u=l(9064);function m(e){let{onFileSelect:s,accept:l={"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},maxSize:m=52428800,uploading:x=!1,progress:h=0}=e,[p,f]=(0,r.useState)(null),j=(0,r.useCallback)(e=>{if(e.length>0){let l=e[0];f(l),s(l)}},[s]),{getRootProps:g,getInputProps:b,isDragActive:v}=(0,a.uI)({onDrop:j,accept:l,maxSize:m,multiple:!1,onDropRejected:e=>{var s;let l=null===(s=e[0])||void 0===s?void 0:s.errors[0];(null==l?void 0:l.code)==="file-too-large"?u.ZP.error("File is too large. Maximum size is 50MB."):(null==l?void 0:l.code)==="file-invalid-type"?u.ZP.error("Invalid file type. Please upload a CSV or Excel file."):u.ZP.error("Failed to upload file.")}});return(0,t.jsx)("div",{className:"w-full",children:p?(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(n.Z,{className:"h-8 w-8 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:p.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(p.size/1024/1024).toFixed(2)," MB"]})]})]}),!x&&(0,t.jsx)(d.z,{variant:"ghost",size:"icon",onClick:()=>{f(null)},children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})]}),x&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.E,{value:h,className:"h-2"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground text-center",children:["Uploading... ",h,"%"]})]})]}):(0,t.jsxs)("div",{...g(),className:"\n            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer\n            transition-colors duration-200\n            ".concat(v?"border-primary bg-primary/5":"border-border hover:border-primary/50","\n          "),children:[(0,t.jsx)("input",{...b()}),(0,t.jsx)(i.Z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium mb-2",children:v?"Drop the file here":"Drag & drop your file here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"or click to browse your files"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Supported formats: CSV, XLS, XLSX (Max 50MB)"})]})})}},9782:function(e,s,l){"use strict";l.d(s,{L:function(){return o}});var t=l(7437),r=l(2265),a=l(5291),i=l(5060),n=l(9174),c=l(2252),d=l(5937);function o(e){let{headers:s,columnTypes:l,suggestions:o,targetFields:u,onChange:m}=e,[x,h]=(0,r.useState)(()=>{let e={};return o.forEach(s=>{e[s.targetField]=s.sourceColumn}),e}),p=(e,s)=>{let l={...x};"none"===s?delete l[e]:l[e]=s,h(l),m(l)},f=e=>{let s=l[e],r={email:"bg-blue-100 text-blue-700",phone:"bg-green-100 text-green-700",url:"bg-purple-100 text-purple-700",name:"bg-orange-100 text-orange-700",company:"bg-indigo-100 text-indigo-700",text:"bg-gray-100 text-gray-700"};return(0,t.jsx)(n.C,{variant:"outline",className:r[s]||r.text,children:s})},j=u.filter(e=>e.required&&!x[e.field]).map(e=>e.label);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Map Your Columns"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:"Match your CSV columns to the enrichment fields. We've suggested some mappings based on your column names."})]}),j.length>0&&(0,t.jsxs)(d.bZ,{variant:"destructive",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4"}),(0,t.jsxs)(d.X,{children:["Missing required fields: ",j.join(", ")]})]}),(0,t.jsx)("div",{className:"space-y-4",children:u.map(e=>(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-center",children:[(0,t.jsx)("div",{children:(0,t.jsxs)(i._,{className:"flex items-center gap-2",children:[e.label,e.required&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]})}),(0,t.jsxs)(a.Ph,{value:x[e.field]||"none",onValueChange:s=>p(e.field,s),children:[(0,t.jsx)(a.i4,{children:(0,t.jsx)(a.ki,{placeholder:"Select a column"})}),(0,t.jsxs)(a.Bw,{children:[(0,t.jsx)(a.Ql,{value:"none",children:"None"}),s.map(e=>(0,t.jsx)(a.Ql,{value:e,children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsx)("span",{children:e}),f(e)]})},e))]})]})]},e.field))}),(0,t.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Column Type Detection"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"We automatically detected the following column types to help with mapping:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-3",children:Object.entries(l).map(e=>{let[s,l]=e;return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("span",{className:"text-sm",children:[s,":"]}),f(s)]},s)})})]})]})}},7204:function(e,s,l){"use strict";l.d(s,{E:function(){return n}});var t=l(7437),r=l(2265),a=l(610),i=l(3448);let n=r.forwardRef((e,s)=>{let{className:l,value:r,...n}=e;return(0,t.jsx)(a.fC,{ref:s,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...n,children:(0,t.jsx)(a.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});n.displayName=a.fC.displayName},1175:function(e,s,l){"use strict";l.d(s,{d:function(){return t}});let t=(0,l(9625).Ue)(e=>({activeJobs:[],addJob:s=>e(e=>({activeJobs:[...e.activeJobs,s]})),updateJob:(s,l)=>e(e=>({activeJobs:e.activeJobs.map(e=>e.id===s?{...e,...l}:e)})),removeJob:s=>e(e=>({activeJobs:e.activeJobs.filter(e=>e.id!==s)}))}))}},function(e){e.O(0,[317,763,383,713,49,418,780,829,801,971,117,744],function(){return e(e.s=3887)}),_N_E=e.O()}]);