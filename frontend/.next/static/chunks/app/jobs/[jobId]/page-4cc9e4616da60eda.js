(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{3376:function(e,t,s){Promise.resolve().then(s.bind(s,7447))},7447:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var o=s(7437),n=s(2265),r=s(9376),i=s(9820),l=s(7204),a=s(2381),c=s(9174),d=s(6305),u=s(7555);class m{setUpdateJobCallback(e){console.log("Update job callback set"),this.updateJobCallback=e}connect(){var e;if(null===(e=this.socket)||void 0===e?void 0:e.connected)return console.log("Socket already connected"),this.socket;let t="http://localhost:3001";return console.log("Attempting to connect to socket:",t),this.disconnect(),this.socket=(0,u.io)(t,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,timeout:5e3,forceNew:!0}),this.attachSocketListeners(),this.socket}attachSocketListeners(){this.socket&&(this.socket.on("connect",()=>{console.log("Socket connected successfully")}),this.socket.on("connect_error",e=>{console.error("Socket connection error:",e)}),this.socket.on("disconnect",e=>{console.log("Socket disconnected:",e)}),this.socket.on("disconnect",e=>{console.log("Socket disconnected:",e)}),this.socket.on("job:progress",e=>{console.log("Job progress received:",e),this.updateJobCallback&&this.updateJobCallback(e.jobId,{progress:e.progress,status:e.status})}),this.socket.on("job:completed",e=>{console.log("Job completed:",e),this.updateJobCallback&&this.updateJobCallback(e.jobId,{status:"completed",completedAt:new Date().toISOString()})}),this.socket.on("job:failed",e=>{console.log("Job failed:",e),this.updateJobCallback&&this.updateJobCallback(e.jobId,{status:"failed"})}))}disconnect(){this.socket&&(console.log("Disconnecting socket"),this.socket.disconnect(),this.socket=null)}subscribeToJob(e){var t;console.log("Subscribing to job:",e),null===(t=this.socket)||void 0===t||t.emit("job:subscribe",{jobId:e})}unsubscribeFromJob(e){var t;console.log("Unsubscribing from job:",e),null===(t=this.socket)||void 0===t||t.emit("job:unsubscribe",{jobId:e})}constructor(){this.socket=null,this.updateJobCallback=null}}let p=new m;var h=s(5863),f=s(6901),v=s(5131),x=s(2660),b=s(2735),g=s(3281),j=s(9064),y=s(5452),N=s.n(y);function k(){let e=(0,r.useParams)(),t=(0,r.useRouter)(),s=e.jobId,[u,m]=(0,n.useState)(null),[y,k]=(0,n.useState)(!0);if((0,n.useEffect)(()=>{let e=async()=>{try{let e=await d.x.getJobStatus(s);m(e.data),k(!1)}catch(e){console.error("Failed to fetch job:",e),k(!1)}};e(),p.subscribeToJob(s);let t=setInterval(e,2e3);return()=>{clearInterval(t),p.unsubscribeFromJob(s)}},[s]),y)return(0,o.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,o.jsx)(h.Z,{className:"h-8 w-8 animate-spin"})});if(!u)return(0,o.jsx)("div",{className:"text-center py-12",children:(0,o.jsx)("p",{className:"text-muted-foreground",children:"Job not found"})});let w=u.progress.total>0?Math.round(u.progress.processed/u.progress.total*100):0;return(0,o.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)(a.z,{variant:"ghost",size:"icon",onClick:()=>t.push("/jobs"),children:(0,o.jsx)(x.Z,{className:"h-4 w-4"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold",children:"Job Details"}),(0,o.jsxs)("p",{className:"text-muted-foreground",children:["ID: ",s]})]})]}),"completed"===u.status&&(0,o.jsxs)(a.z,{onClick:()=>{if(console.log("Inspecting job.results for export:",null==u?void 0:u.results),(null==u?void 0:u.status)!=="completed"||!u.results||0===u.results.length){j.ZP.error("No successful results to export.");return}try{let e;"enrich-person"===u.jobType?e=u.results.map(e=>{var t,s,o,n;return{"Full Name":e.fullName,"First Name":e.firstName,"Last Name":e.lastName,Email:e.email,Phone:e.phone,"Job Title":e.title,"Company Name":e.company,"Company Domain":e.companyDomain,"LinkedIn URL":e.linkedinUrl,Location:e.location,Seniority:null===(s=e.additionalData)||void 0===s?void 0:null===(t=s.seniorities)||void 0===t?void 0:t.join("; "),Departments:null===(n=e.additionalData)||void 0===n?void 0:null===(o=n.departments)||void 0===o?void 0:o.join("; ")}}):"enrich-company"===u.jobType?e=u.results.map(e=>{var t,s,o,n,r,i,l,a,c,d,u,m,p,h,f,v,x,b,g,j,y,N,k,w,C;return{Name:null!==(u=e.name)&&void 0!==u?u:"",Domain:null!==(m=e.domain)&&void 0!==m?m:"",Description:null!==(p=e.description)&&void 0!==p?p:"",Industry:null!==(h=e.industry)&&void 0!==h?h:"",Size:null!==(f=e.size)&&void 0!==f?f:"",Location:null!==(v=e.location)&&void 0!==v?v:"","LinkedIn URL":null!==(x=e.linkedinUrl)&&void 0!==x?x:"","Employee Count":null!==(b=null===(t=e.additionalData)||void 0===t?void 0:t.employeeCount)&&void 0!==b?b:"N/A",Founded:null!==(g=null===(s=e.additionalData)||void 0===s?void 0:s.founded)&&void 0!==g?g:"N/A",Revenue:null!==(j=null===(o=e.additionalData)||void 0===o?void 0:o.revenue)&&void 0!==j?j:"N/A","HQ Country":null!==(y=null===(n=e.additionalData)||void 0===n?void 0:n.hqCountry)&&void 0!==y?y:"N/A","Is Public":null!==(N=null===(r=e.additionalData)||void 0===r?void 0:r.isPublic)&&void 0!==N?N:"N/A",Technologies:null!==(k=null===(i=e.technologies)||void 0===i?void 0:i.join("; "))&&void 0!==k?k:"",Phones:null!==(w=null===(a=e.additionalData)||void 0===a?void 0:null===(l=a.phones)||void 0===l?void 0:l.join("; "))&&void 0!==w?w:"",Websites:null!==(C=null===(d=e.additionalData)||void 0===d?void 0:null===(c=d.websites)||void 0===c?void 0:c.join("; "))&&void 0!==C?C:""}}):(e=u.results,j.ZP.success("Exporting raw JSON for unknown job type."));let t=N().unparse(e),o=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(o);n.setAttribute("href",r),n.setAttribute("download","job-results-".concat(s,".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),j.ZP.success("Results exported successfully!")}catch(e){console.error("Failed to export CSV:",e),j.ZP.error("An error occurred during export.")}},children:[(0,o.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Export Results"]})]}),(0,o.jsxs)(i.Zb,{children:[(0,o.jsxs)(i.Ol,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)(i.ll,{children:"Progress"}),(()=>{let e=u.displayStatus||u.status,t={queued:{variant:"secondary",icon:h.Z},processing:{variant:"default",icon:h.Z},completed:{variant:"success",icon:f.Z},failed:{variant:"destructive",icon:v.Z},expired:{variant:"outline",icon:f.Z}},s=t[e]||t.queued,n=s.icon;return(0,o.jsxs)(c.C,{variant:s.variant,children:[(0,o.jsx)(n,{className:"h-3 w-3 mr-1"}),e]})})()]}),(0,o.jsxs)(i.SZ,{children:["Started ",(0,g.Z)(new Date(u.createdAt),"PPp")]})]}),(0,o.jsxs)(i.aY,{className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,o.jsx)("span",{children:"Progress"}),(0,o.jsxs)("span",{children:[w,"%"]})]}),(0,o.jsx)(l.E,{value:w,className:"h-3"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("p",{className:"text-2xl font-bold",children:u.progress.total}),(0,o.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("p",{className:"text-2xl font-bold",children:u.progress.processed}),(0,o.jsx)("p",{className:"text-sm text-muted-foreground",children:"Processed"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-green-600",children:u.progress.successful}),(0,o.jsx)("p",{className:"text-sm text-muted-foreground",children:"Successful"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("p",{className:"text-2xl font-bold text-red-600",children:u.progress.failed}),(0,o.jsx)("p",{className:"text-sm text-muted-foreground",children:"Failed"})]})]}),u.completedAt&&(0,o.jsxs)("div",{className:"pt-4 border-t",children:[(0,o.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Completed ",(0,g.Z)(new Date(u.completedAt),"PPp")]}),(0,o.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Duration: ",Math.round((new Date(u.completedAt).getTime()-new Date(u.createdAt).getTime())/1e3)," ","seconds"]})]})]})]}),u.logs.length>0&&(0,o.jsxs)(i.Zb,{children:[(0,o.jsxs)(i.Ol,{children:[(0,o.jsx)(i.ll,{children:"Logs"}),(0,o.jsx)(i.SZ,{children:"Real-time processing logs"})]}),(0,o.jsx)(i.aY,{children:(0,o.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:u.logs.map(e=>(0,o.jsxs)("div",{className:"text-sm p-2 rounded ".concat("error"===e.level?"bg-red-50 text-red-700":"warn"===e.level?"bg-yellow-50 text-yellow-700":"bg-gray-50 text-gray-700"),children:[(0,o.jsx)("span",{className:"font-mono text-xs",children:(0,g.Z)(new Date(e.timestamp),"HH:mm:ss")})," ",e.message]},e.id))})})]})]})}},9174:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var o=s(7437);s(2265);var n=s(7712),r=s(3448);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-500/80"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...n}=e;return(0,o.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...n})}},2381:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var o=s(7437),n=s(2265),r=s(7053),i=s(7712),l=s(3448);let a=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:c=!1,...d}=e,u=c?r.g7:"button";return(0,o.jsx)(u,{className:(0,l.cn)(a({variant:n,size:i,className:s})),ref:t,...d})});c.displayName="Button"},9820:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return a}});var o=s(7437),n=s(2265),r=s(3448);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let a=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});a.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});d.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter"},7204:function(e,t,s){"use strict";s.d(t,{E:function(){return l}});var o=s(7437),n=s(2265),r=s(610),i=s(3448);let l=n.forwardRef((e,t)=>{let{className:s,value:n,...l}=e;return(0,o.jsx)(r.fC,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...l,children:(0,o.jsx)(r.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});l.displayName=r.fC.displayName},6305:function(e,t,s){"use strict";s.d(t,{x:function(){return n}});class o{async request(e,t){let s=this.getToken(),o=new Headers(t.headers);o.set("Content-Type","application/json"),s&&o.set("Authorization","Bearer ".concat(s));let n=await fetch("".concat(this.baseURL).concat(e),{...t,headers:o});if(204===n.status)return{success:!0,data:null};let r=await n.json();if(!n.ok){var i;throw Error((null===(i=r.error)||void 0===i?void 0:i.message)||"HTTP error! status: ".concat(n.status))}return r}async get(e,t){return console.log("\uD83C\uDF10 Making GET request to:",e),this.request(e,{...t,method:"GET"})}async post(e,t,s){return this.request(e,{...s,method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t,s){return this.request(e,{...s,method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e,t){return this.request(e,{...t,method:"DELETE"})}async getJobs(){console.log("2. [apiClient] getJobs() method called.");let e=this.get("/api/jobs");return console.log("3. [apiClient] get(/api/jobs) promise returned."),e}async getJobStatus(e){return this.get("/api/jobs/".concat(e))}async getProviders(){return this.get("/api/providers")}async testProvider(e){return this.post("/api/providers/".concat(e,"/test"))}async executeProvider(e,t){return this.post("/api/providers/".concat(e,"/execute"),t)}constructor(){this.baseURL="http://localhost:3002",this.getToken=()=>localStorage.getItem("authToken"),console.log("API Client initialized with URL:",this.baseURL)}}let n=new o;t.Z=n},3448:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var o=s(1994),n=s(3335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,o.W)(t))}}},function(e){e.O(0,[317,383,281,74,971,117,744],function(){return e(e.s=3376)}),_N_E=e.O()}]);